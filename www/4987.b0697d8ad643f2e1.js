"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4987],{4987:(S,c,s)=>{s.r(c),s.d(c,{LoginPageModule:()=>L});var h=s(6895),r=s(433),n=s(4556),u=s(131),d=s(655),g=s(1566),e=s(8256),f=s(7556),p=s(9055);function y(t,l){1&t&&(e.TgZ(0,"ion-note",11),e._uU(1,"Email is invalid"),e.qZA())}function v(t,l){1&t&&(e.TgZ(0,"ion-note",11),e._uU(1,"Password needs to be 6 characters"),e.qZA())}const P=[{path:"",component:(()=>{class t{constructor(i,o,a,m,U,Z,T,C){this.fb=i,this.loadingController=o,this.alertController=a,this.authService=m,this.router=U,this.menuCtrl=Z,this.firestore=T,this.auth=C}get email(){return this.credentials.get("email")}get password(){return this.credentials.get("password")}ionViewWillEnter(){this.menuCtrl.enable(!1)}ngOnInit(){this.credentials=this.fb.group({email:["",[r.kI.required,r.kI.email]],password:["",[r.kI.required,r.kI.minLength(6)]]}),null!=this.authService.getAuth.currentUser&&this.authService.logout()}register(){return(0,d.mG)(this,void 0,void 0,function*(){const i=yield this.loadingController.create();yield i.present();const o=yield this.authService.register(this.credentials.value);yield i.dismiss(),o?yield this.router.navigateByUrl("/home",{replaceUrl:!0}):yield this.showAlert("Registration failed","Please try again!")})}login(){return(0,d.mG)(this,void 0,void 0,function*(){const i=yield this.loadingController.create();yield i.present();const o=yield this.authService.login(this.credentials.value);if(yield i.dismiss(),o){const a=(0,g.JU)(this.firestore,"admins",this.auth.currentUser.uid);(yield(0,g.QT)(a)).exists()&&(yield(0,g.pl)((0,g.JU)(this.firestore,"locations",this.auth.currentUser.uid),{isAdmin:!0},{merge:!0})),yield this.router.navigateByUrl("/home",{replaceUrl:!0})}else yield this.showAlert("Login failed","Please try again!")})}showAlert(i,o){return(0,d.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({header:i,message:o,buttons:["OK"]})).present()})}}return t.\u0275fac=function(i){return new(i||t)(e.Y36(r.qu),e.Y36(n.HT),e.Y36(n.Br),e.Y36(f.e),e.Y36(u.F0),e.Y36(n._q),e.Y36(g.gg),e.Y36(p.gx))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-login"]],decls:23,vars:4,consts:[[1,"ion-padding"],["src","/assets/icon/favicon.png","alt","logo",1,"login-logo"],[3,"formGroup","ngSubmit"],["fill","solid",1,"ion-margin-bottom"],["type","email","placeholder","Email","formControlName","email"],["slot","error",4,"ngIf"],["type","password","placeholder","Password","formControlName","password"],["type","submit","expand","block",3,"disabled"],["type","button","expand","block","color","secondary",3,"click"],[1,"ion-text-center"],[1,"login-subtitle"],["slot","error"]],template:function(i,o){1&i&&(e.TgZ(0,"ion-content",0)(1,"ion-grid")(2,"ion-row")(3,"ion-col"),e._UZ(4,"ion-img",1),e.qZA()(),e.TgZ(5,"ion-row")(6,"ion-col")(7,"form",2),e.NdJ("ngSubmit",function(){return o.login()}),e.TgZ(8,"ion-item",3),e._UZ(9,"ion-input",4),e.YNc(10,y,2,0,"ion-note",5),e.qZA(),e.TgZ(11,"ion-item",3),e._UZ(12,"ion-input",6),e.YNc(13,v,2,0,"ion-note",5),e.qZA(),e.TgZ(14,"ion-button",7),e._uU(15,"Log in"),e.qZA(),e.TgZ(16,"ion-button",8),e.NdJ("click",function(){return o.register()}),e._uU(17,"Create account"),e.qZA()()()(),e.TgZ(18,"ion-row")(19,"ion-col")(20,"div",9)(21,"h3",10),e._uU(22,"HANDA AKO: NATURAL DISASTER AND RISK REDUCTION AND PREPAREDNESS"),e.qZA()()()()()()),2&i&&(e.xp6(7),e.Q6J("formGroup",o.credentials),e.xp6(3),e.Q6J("ngIf",(o.email.dirty||o.email.touched)&&o.email.errors),e.xp6(3),e.Q6J("ngIf",(o.password.dirty||o.password.touched)&&o.password.errors),e.xp6(1),e.Q6J("disabled",!o.credentials.valid))},dependencies:[h.O5,r._Y,r.JJ,r.JL,n.YG,n.wI,n.W2,n.jY,n.Xz,n.pK,n.Ie,n.uN,n.Nd,n.j9,r.sg,r.u],styles:[".login-subtitle[_ngcontent-%COMP%]{font-size:16px;line-height:26px;color:#000}.login-logo[_ngcontent-%COMP%]{width:60%;height:auto;margin-right:auto;margin-left:auto}ion-grid[_ngcontent-%COMP%]{height:100%}ion-row[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:30%}"]}),t})()}];let A=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[u.Bz.forChild(P),u.Bz]}),t})(),L=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[h.ez,r.u5,n.Pc,A,r.UX]}),t})()}}]);