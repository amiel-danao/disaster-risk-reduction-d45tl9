"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5689],{5689:(S,c,r)=>{r.r(c),r.d(c,{LoginPageModule:()=>w});var h=r(6895),s=r(433),n=r(4556),g=r(131),u=r(655),d=r(1566),m=r(7423);const f=(0,m.fo)("Keyboard");var e=r(8256),y=r(7556),v=r(9055);function P(i,l){1&i&&(e.TgZ(0,"ion-note",12),e._uU(1,"Email is invalid"),e.qZA())}function A(i,l){1&i&&(e.TgZ(0,"ion-note",12),e._uU(1,"Password needs to be 6 characters"),e.qZA())}const L=[{path:"",component:(()=>{class i{constructor(o,t,a,p,U,Z,T,C){this.fb=o,this.loadingController=t,this.alertController=a,this.authService=p,this.router=U,this.menuCtrl=Z,this.firestore=T,this.auth=C,this.showOthers=!0}get email(){return this.credentials.get("email")}get password(){return this.credentials.get("password")}ionViewWillEnter(){this.menuCtrl.enable(!1)}ngOnInit(){m.dV.isPluginAvailable("Keyboard")&&(f.addListener("keyboardDidShow",()=>{this.showOthers=!1}),f.addListener("keyboardDidHide",()=>{this.showOthers=!0})),this.credentials=this.fb.group({email:["",[s.kI.required,s.kI.email]],password:["",[s.kI.required,s.kI.minLength(6)]]}),null!=this.authService.getAuth.currentUser&&this.authService.logout()}register(){return(0,u.mG)(this,void 0,void 0,function*(){const o=yield this.loadingController.create();yield o.present();const t=yield this.authService.register(this.credentials.value);yield o.dismiss(),t?yield this.router.navigateByUrl("/home",{replaceUrl:!0}):yield this.showAlert("Registration failed","Please try again!")})}login(){return(0,u.mG)(this,void 0,void 0,function*(){const o=yield this.loadingController.create();yield o.present();const t=yield this.authService.login(this.credentials.value);if(yield o.dismiss(),t){const a=(0,d.JU)(this.firestore,"admins",this.auth.currentUser.uid);(yield(0,d.QT)(a)).exists()&&(yield(0,d.pl)((0,d.JU)(this.firestore,"locations",this.auth.currentUser.uid),{isAdmin:!0},{merge:!0})),yield this.router.navigateByUrl("/home",{replaceUrl:!0})}else yield this.showAlert("Login failed","Please try again!")})}showAlert(o,t){return(0,u.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({header:o,message:t,buttons:["OK"]})).present()})}}return i.\u0275fac=function(o){return new(o||i)(e.Y36(s.qu),e.Y36(n.HT),e.Y36(n.Br),e.Y36(y.e),e.Y36(g.F0),e.Y36(n._q),e.Y36(d.gg),e.Y36(v.gx))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-login"]],decls:23,vars:8,consts:[[1,"ion-padding",3,"fullscreen","scrollEvents"],[3,"hidden"],["src","/assets/icon/favicon.png","alt","logo",1,"login-logo"],[3,"formGroup","ngSubmit"],["fill","solid",1,"ion-margin-bottom"],["type","email","placeholder","Email","formControlName","email"],["slot","error",4,"ngIf"],["type","password","placeholder","Password","formControlName","password"],["type","submit","expand","block",3,"disabled"],["type","button","expand","block","color","secondary",3,"click"],[1,"ion-text-center"],[1,"login-subtitle"],["slot","error"]],template:function(o,t){1&o&&(e.TgZ(0,"ion-content",0)(1,"ion-grid")(2,"ion-row",1)(3,"ion-col"),e._UZ(4,"ion-img",2),e.qZA()(),e.TgZ(5,"ion-row")(6,"ion-col")(7,"form",3),e.NdJ("ngSubmit",function(){return t.login()}),e.TgZ(8,"ion-item",4),e._UZ(9,"ion-input",5),e.YNc(10,P,2,0,"ion-note",6),e.qZA(),e.TgZ(11,"ion-item",4),e._UZ(12,"ion-input",7),e.YNc(13,A,2,0,"ion-note",6),e.qZA(),e.TgZ(14,"ion-button",8),e._uU(15,"Log in"),e.qZA(),e.TgZ(16,"ion-button",9),e.NdJ("click",function(){return t.register()}),e._uU(17,"Create account"),e.qZA()()()(),e.TgZ(18,"ion-row",1)(19,"ion-col")(20,"div",10)(21,"h3",11),e._uU(22,"HANDA AKO: NATURAL DISASTER AND RISK REDUCTION AND PREPAREDNESS"),e.qZA()()()()()()),2&o&&(e.Q6J("fullscreen",!0)("scrollEvents",!0),e.xp6(2),e.Q6J("hidden",!t.showOthers),e.xp6(5),e.Q6J("formGroup",t.credentials),e.xp6(3),e.Q6J("ngIf",(t.email.dirty||t.email.touched)&&t.email.errors),e.xp6(3),e.Q6J("ngIf",(t.password.dirty||t.password.touched)&&t.password.errors),e.xp6(1),e.Q6J("disabled",!t.credentials.valid),e.xp6(4),e.Q6J("hidden",!t.showOthers))},dependencies:[h.O5,s._Y,s.JJ,s.JL,n.YG,n.wI,n.W2,n.jY,n.Xz,n.pK,n.Ie,n.uN,n.Nd,n.j9,s.sg,s.u],styles:[".login-subtitle[_ngcontent-%COMP%]{font-size:16px;line-height:26px;color:#000}.login-logo[_ngcontent-%COMP%]{width:60%;height:auto;margin-right:auto;margin-left:auto}ion-grid[_ngcontent-%COMP%]{height:100%}ion-row[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:30%}"]}),i})()}];let b=(()=>{class i{}return i.\u0275fac=function(o){return new(o||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[g.Bz.forChild(L),g.Bz]}),i})(),w=(()=>{class i{}return i.\u0275fac=function(o){return new(o||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[h.ez,s.u5,n.Pc,b,s.UX]}),i})()}}]);